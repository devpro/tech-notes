# Infrastructure-as-Code (IaC)

## Technologies

Key Element                   | Terraform                                                                                                 | Ansible                                                             | Puppet
------------------------------|-----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|-------------------------------------------------------------------------
**Purpose**                   | Infrastructure provisioning                                                                               | Configuration management and task automation                        | Configuration management and server automation
**Architecture**              | Client-only, interacts directly with provider APIs                                                        | Agentless, uses SSH (or WinRM for Windows) for push-based execution | Client-server model with Puppet Server and agents (pull-based)
**Language**                  | HCL (HashiCorp Configuration Language) or JSON                                                            | YAML (playbooks)                                                    | Puppet DSL (Ruby-based)
**Idempotency**               | Yes, reconciles desired state with actual state via state file                                            | Yes, tasks only apply changes when needed                           | Yes, ensures consistent state via catalog application
**State Management**          | Uses `terraform.tfstate` to track infrastructure state (critical, stored locally or remotely)             | Stateless; relies on system state and idempotent tasks              | State managed via PuppetDB and catalogs, compiled by Puppet Server
**Key Components**            | Resources, providers, modules, state file, backend                                                        | Playbooks, inventory, roles, modules, tasks                         | Manifests, modules, resources, Facter, Hiera, PuppetDB
**Execution Model**           | Declarative; `terraform plan` previews, `terraform apply` executes                                        | Push-based; `ansible-playbook` pushes tasks to hosts                | Pull-based; agents poll Puppet Server for catalogs
**Sensitive Data Handling**   | Variables, `.tfvars`, remote backends (e.g., S3), or Vault integration                                    | Ansible Vault, external tools (e.g., HashiCorp Vault)               | Hiera with `hiera-eyaml`, external tools (e.g., Vault)
**Modularity**                | Modules for reusable configurations, stored in Terraform Registry                                         | Roles and collections (modules & plugins), stored in Ansible Galaxy | Modules for reusable manifests, stored in Puppet Forge
**Inventory/Node Management** | Not applicable; manages infrastructure, not nodes                                                         | Static or dynamic inventory (e.g., `aws_ec2` plugin)                | Node classification via Puppet Server or external node classifiers (ENC)
**Environment Management**    | Workspaces or separate directories with `.tfvars` for dev/staging/prod                                    | Separate inventories or `group_vars` for dev/prod                   | Environments in `/etc/puppetlabs/code/environments` with Hiera data
**Error Handling**            | Debug with `terraform plan`, logs, or `terraform apply -replace` for resource issues (instead of `taint`) | Use `ignore_errors`, `failed_when`, or `--verbose` for debugging    | Debug with `puppet agent --debug`, logs, or `fail()` function
**Testing Tools**             | `terraform validate`, Terratest, Checkov, TFLint                                                          | `ansible-lint`, Molecule, `--check` mode                            | `puppet-lint`, `rspec-puppet`, `puppet parser validate`
**Scalability**               | Scales via remote backends (e.g., S3, Terraform Cloud) with locking                                       | Scales with `strategy: free`, `forks`, or Ansible Tower             | Scales with Puppetserver tuning, PuppetDB, or HA Puppet Server
**Security Best Practices**   | Encrypt state files, use IAM roles, remote backends with locking                                          | Use Ansible Vault, secure SSH keys, restrict playbook access        | Use SSL for Puppet Server, Hiera encryption, RBAC
**Common Integrations**       | Terraform Cloud, Infracost, AWS/GCP/Azure providers                                                       | Ansible Tower/AWX, dynamic inventory plugins, Vault                 | Puppet Enterprise, PuppetDB, r10k, Puppet Forge
**Use Case Example**          | Provision AWS VPC, EC2, and RDS across regions                                                            | Configure Nginx, manage users on multiple servers                   | Manage Apache, MySQL configs, and services on Linux/Windows servers
**Key differenciator**        | Provisioning focus                                                                                        | Agentless simplicity                                                | Client-server robustness
